#!/usr/bin/ksh
# IBM_PROLOG_BEGIN_TAG 
# This is an automatically generated prolog. 
#  
# gos530 src/gos/2d/XTOP/aixclients/xdm/config/TakeConsole 1.3 
#  
# Licensed Materials - Property of IBM 
#  
# (C) COPYRIGHT International Business Machines Corp. 1992,1998 
# All Rights Reserved 
#  
# US Government Users Restricted Rights - Use, duplication or 
# disclosure restricted by GSA ADP Schedule Contract with IBM Corp. 
#  
# IBM_PROLOG_END_TAG 
# @(#)69        1.3  src/gos/2d/XTOP/aixclients/xdm/config/TakeConsole, xdmcp, gos530 2/26/98 15:59:46

 
# Reassign ownership of the console to root, this should disallow
# assignment of console output to any random users's xterm
if [ $DISPLAY = ":0" ]; then
    chmod 622 /dev/console
    chown root /dev/console
fi

PORT=`echo $DISPLAY | /usr/bin/sed "s/\./_/g" | /usr/bin/sed "s/:/_/g" | /usr/bin/cut -c1-8`
if [ -n "$PORT" ]; then
    # use sessreg to add the /etc/utmp and /usr/adm/wtmp entries
    # to end this login session.
    /usr/lib/X11/xdm/sessreg -d -l xdm/$PORT $USER
fi

